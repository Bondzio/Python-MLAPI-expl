#!/usr/bin/env python
# coding: utf-8

# I have used different KFolds techniques with Light GBM Classifier and stacked them together.
# 
# This solution fetched me a Silver medal in the Competition.

# In[ ]:


import numpy as np
import pandas as pd
import os

from scipy.stats import rankdata

LABELS = ["HasDetections"]


# In[ ]:


get_ipython().system('ls ../input/last-stages')


# In[ ]:


get_ipython().system('ls ../input/laststages')


# In[ ]:


get_ipython().system('ls ../input/aimalware')


# In[ ]:


predict_list = []
predict_list.append(pd.read_csv("../input/aimalware/nffm_submission.csv")[LABELS].values)
predict_list.append(pd.read_csv("../input/last-stages/submission_ashish_v2.csv")[LABELS].values)
predict_list.append(pd.read_csv("../input/laststages/submission_ashish_v3.csv")[LABELS].values)
predict_list.append(pd.read_csv("../input/last-stages/submission_ashish_v4.csv")[LABELS].values)
predict_list.append(pd.read_csv("../input/last-stages/submission_ashish_vb1.csv")[LABELS].values)
predict_list.append(pd.read_csv("../input/finalai/blending.csv")[LABELS].values)


# In[ ]:


print("Rank averaging on ", len(predict_list), " files")
predictions = np.zeros_like(predict_list[0])
for predict in predict_list:
    for i in range(1):
        predictions[:, i] = np.add(predictions[:, i], rankdata(predict[:, i])/predictions.shape[0])  
predictions /= len(predict_list)

submission = pd.read_csv('../input/microsoft-malware-prediction/sample_submission.csv')
submission[LABELS] = predictions
submission.to_csv('super_blend.csv', index=False)


# In[ ]:


submission.head()


# In[ ]:


#another blend
submission = pd.read_csv('../input/microsoft-malware-prediction/sample_submission.csv')

sample_3 = pd.read_csv("../input/last-stages/submission_ashish_v2.csv")
sample_4 = pd.read_csv("../input/laststages/submission_ashish_v3.csv")
sample_5 = pd.read_csv("../input/last-stages/submission_ashish_v4.csv")
sample_6 = pd.read_csv("../input/last-stages/submission_ashish_vb1.csv")
sample_7 = pd.read_csv("../input/aimalware/nffm_submission.csv")
sample_8 = pd.read_csv("../input/finalai/blending.csv")

submission['HasDetections'] = sample_6['HasDetections'] * 0.3 + sample_8['HasDetections'] * 0.3 + sample_3['HasDetections'] * 0.2 + sample_7['HasDetections'] * 0.2
submission.to_csv('super_blend_2.csv', index=False)

